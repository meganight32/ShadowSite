<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ShadowSite</title>
<style>
  :root {
    /* Default theme colors (blue) */
    --color-primary: #00aaff;
    --color-primary-light: #66d0ff;
    --color-background-light: #f5faff;
    --color-background-dark: #0a0a0a;
    --color-text-light: #222;
    --color-text-dark: #ddd;
    --color-link: var(--color-primary);
    --color-link-hover: var(--color-primary-light);
  }

  /* Dark mode */
  body.dark {
    background-color: var(--color-background-dark);
    color: var(--color-text-dark);
  }
  /* Light mode */
  body.light {
    background-color: var(--color-background-light);
    color: var(--color-text-light);
  }

  body {
    margin: 0;
    font-family: Arial, sans-serif;
    transition: background-color 0.4s ease, color 0.4s ease;
    background-color: var(--color-background-dark);
    color: var(--color-text-dark);
  }

  a {
    color: var(--color-link);
    text-decoration: none;
    transition: color 0.3s ease;
  }
  a:hover, a:focus {
    color: var(--color-link-hover);
    outline: none;
  }

  header {
    background-color: var(--color-primary);
    color: #001a2e;
    padding: 15px 20px;
    font-size: 1.8rem;
    font-weight: bold;
    user-select: none;
  }

  nav {
    display: flex;
    background-color: var(--color-primary);
  }
  nav button.tablink {
    flex-grow: 1;
    background-color: var(--color-primary);
    border: none;
    padding: 12px 15px;
    color: #001a2e;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  nav button.tablink:hover,
  nav button.tablink.active {
    background-color: var(--color-primary-light);
    color: #000;
    outline: none;
  }

  main {
    padding: 20px;
    min-height: 70vh;
  }

  section.tab {
    display: none;
  }
  section.tab.active {
    display: block;
  }

  /* Announcement Box */
  #announcement {
    background-color: var(--color-primary);
    padding: 12px 15px;
    border-radius: 6px;
    margin-bottom: 20px;
    font-weight: bold;
    color: #001a2e;
  }

  /* Users Favorites Box */
  #users-favorites {
    margin-top: 20px;
    padding: 15px;
    border: 1px solid var(--color-primary-light);
    border-radius: 8px;
    background-color: rgba(0, 170, 255, 0.1);
  }
  #users-favorites h3 {
    margin-top: 0;
    color: var(--color-primary);
  }
  #users-favorites ul {
    list-style-type: disc;
    margin-left: 20px;
  }
  #users-favorites li a {
    color: var(--color-primary);
  }
  #users-favorites li a:hover {
    color: var(--color-primary-light);
  }

  /* Changelog and Credits Box */
  #changelog, #credits {
    margin-top: 20px;
    padding: 15px;
    border-radius: 8px;
    background-color: rgba(0, 170, 255, 0.15);
    border: 1px solid var(--color-primary-light);
    color: var(--color-text-dark);
  }
  #changelog h2, #credits h2 {
    margin-top: 0;
    color: var(--color-primary);
  }
  #changelog button.close, #credits button.close {
    float: right;
    background: none;
    border: none;
    color: var(--color-primary);
    font-size: 1.2rem;
    font-weight: bold;
    cursor: pointer;
    padding: 0 5px;
  }

  /* Weather & Time Bar */
  #weather-time-bar {
    background-color: rgba(0, 170, 255, 0.1);
    color: var(--color-primary-light);
    font-weight: 600;
    font-size: 0.9rem;
    padding: 5px 15px;
    border-radius: 0 0 12px 12px;
    display: flex;
    justify-content: flex-end;
    align-items: center;
    user-select: none;
    letter-spacing: 0.05em;
  }

  /* Settings tab */
  #settings label {
    display: block;
    margin-top: 15px;
    font-weight: bold;
  }
  #settings input[type="text"], #settings input[type="url"], #settings select {
    width: 250px;
    padding: 7px;
    margin-top: 6px;
    border-radius: 6px;
    border: 1px solid var(--color-primary-light);
    background-color: transparent;
    color: inherit;
    font-size: 1rem;
  }
  #settings button {
    margin-top: 12px;
    padding: 10px 18px;
    background-color: var(--color-primary);
    border: none;
    border-radius: 8px;
    color: #001a2e;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 0 8px var(--color-primary-light);
    transition: background-color 0.3s ease;
  }
  #settings button:hover, #settings button:focus {
    background-color: var(--color-primary-light);
    outline: none;
  }

  /* Panic Key info */
  #panic-info {
    margin-top: 10px;
    font-size: 0.9rem;
    color: var(--color-primary-light);
  }

  /* Password screen */
  #password-screen {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: #001a2e;
    color: #00aaff;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    z-index: 9999;
    font-family: 'Courier New', Courier, monospace;
  }
  #password-screen input[type="password"] {
    font-size: 1.3rem;
    padding: 10px;
    border: none;
    border-radius: 6px;
    margin-bottom: 10px;
    width: 220px;
    text-align: center;
    letter-spacing: 0.2em;
  }
  #password-screen button {
    font-size: 1.1rem;
    background-color: var(--color-primary);
    color: #001a2e;
    border: none;
    border-radius: 6px;
    padding: 10px 25px;
    cursor: pointer;
    box-shadow: 0 0 12px var(--color-primary-light);
  }
  #password-error {
    color: #f00;
    margin-top: 10px;
    font-weight: bold;
  }

</style>
</head>
<body>

<div id="password-screen" aria-label="Password entry screen" role="dialog" aria-modal="true" aria-live="polite">
  <label for="password-input" style="font-size:1.5rem; margin-bottom:10px;">Enter Password to Access ShadowSite:</label>
  <input type="password" id="password-input" aria-describedby="password-error" placeholder="Password" autocomplete="off" />
  <button id="password-submit">Enter</button>
  <div id="password-error" role="alert" aria-live="assertive"></div>
</div>

<header>ShadowSite</header>

<nav role="navigation" aria-label="Primary">
  <button class="tablink active" data-tab="home" aria-selected="true" tabindex="0">Home</button>
  <button class="tablink" data-tab="proxy" tabindex="-1">Proxy</button>
  <button class="tablink" data-tab="games" tabindex="-1">Games</button>
  <button class="tablink" data-tab="entertainment" tabindex="-1">Entertainment</button>
  <button class="tablink" data-tab="unblocked" tabindex="-1">Unblocked Games</button>
  <button class="tablink" data-tab="support" tabindex="-1">Support</button>
  <button class="tablink" data-tab="settings" tabindex="-1">Settings</button>
</nav>

<div id="weather-time-bar" aria-live="polite" aria-atomic="true" aria-label="Local time and weather information" role="region" style="display:none;">
  Loading local time and weather...
</div>

<main>
  <!-- Home Tab -->
  <section id="home" class="tab active" role="tabpanel" tabindex="0" aria-label="Home Tab">
    <h1>Welcome to ShadowSite</h1>
    <p>Your go-to site for proxies, games, and entertainment.</p>

    <div id="announcement" aria-live="polite" aria-atomic="true">
      <!-- CHANGE ANNOUNCEMENT TEXT BELOW -->
      <strong>Announcement:</strong> New proxies added! Check them out in the Proxy tab.
    </div>

    <div id="users-favorites" aria-label="Users favorite proxies and games">
      <h3>Users Favorites</h3>
      <div>
        <h4>Proxies</h4>
        <ul>
          <li><a href="https://exampleproxy1.com" target="_blank" rel="noopener noreferrer">exampleproxy1.com</a></li>
          <li><a href="https://exampleproxy2.com" target="_blank" rel="noopener noreferrer">exampleproxy2.com</a></li>
        </ul>
      </div>
      <div>
        <h4>Games</h4>
        <ul>
          <li><a href="https://examplegame1.com" target="_blank" rel="noopener noreferrer">Example Game 1</a></li>
          <li><a href="https://examplegame2.com" target="_blank" rel="noopener noreferrer">Example Game 2</a></li>
        </ul>
      </div>
    </div>

    <div id="changelog" role="region" aria-label="Changelog">
      <button class="close" aria-label="Close changelog">&times;</button>
      <h2>Changelog</h2>
      <ul>
        <li>Added password protection.</li>
        <li>Added dark/light mode and theme switcher.</li>
        <li>Added panic key functionality.</li>
        <li>Integrated weather and local time bar.</li>
        <li>Updated support tab with Formspree.</li>
      </ul>
    </div>

    <div id="credits" role="region" aria-label="Credits">
      <button class="close" aria-label="Close credits">&times;</button>
      <h2>Credits</h2>
      <ul>
        <li>Site designed and coded by Blake Chesebro.</li>
        <li>Weather data powered by OpenWeatherMap API.</li>
        <li>Icons and graphics by free sources.</li>
      </ul>
    </div>
  </section>

  <!-- Proxy Tab -->
  <section id="proxy" class="tab" role="tabpanel" tabindex="0" aria-label="Proxy Tab">
    <h2>Proxy Links</h2>
    <p>Browse privately and bypass restrictions with these trusted proxy links. Use them to enhance your online privacy and access blocked content.</p>

    <!-- Bolt Proxies -->
    <h3>Bolt Proxy Links</h3>
    <ul class="link-list">
      <li><a href="http://funlearning.ra3.us/" target="_blank" rel="noopener noreferrer">funlearning.ra3.us</a></li>
      <li><a href="http://mathymath.cueros-roblans.com.ar/" target="_blank" rel="noopener noreferrer">mathymath.cueros-roblans.com.ar</a></li>
      <li><a href="https://fnrkrbvtpy.abbotsfordhallforhire.org.au/" target="_blank" rel="noopener noreferrer">fnrkrbvtpy.abbotsfordhallforhire.org.au</a></li>
      <li><a href="http://boltunblocker.com/" target="_blank" rel="noopener noreferrer">boltunblocker.com</a></li>
      <li><a href="https://anamoxe.baselinux.net/" target="_blank" rel="noopener noreferrer">anamoxe.baselinux.net</a></li>
      <li><a href="https://nirbytesboltxero.chickenkiller.com/" target="_blank" rel="noopener noreferrer">nirbytesboltxero.chickenkiller.com</a></li>
      <li><a href="https://lnienmniry.baselinux.net" target="_blank" rel="noopener noreferrer">lnienmniry.baselinux.net</a></li>
      <li><a href="https://samjabie.baselinux.net" target="_blank" rel="noopener noreferrer">samjabie.baselinux.net</a></li>
      <li><a href="https://sandeking.baselinux.net" target="_blank" rel="noopener noreferrer">sandeking.baselinux.net</a></li>
      <li><a href="http://neclcafxoz.expedicionesytrekking.com/" target="_blank" rel="noopener noreferrer">neclcafxoz.expedicionesytrekking.com</a></li>
      <li><a href="http://evoodherne.mygadgets.com.ar/" target="_blank" rel="noopener noreferrer">evoodherne.mygadgets.com.ar</a></li>
      <li><a href="https://boltnixe.baselinux.net/" target="_blank" rel="noopener noreferrer">boltnixe.baselinux.net</a></li>
      <li><a href="https://clearinxg.baselinux.net" target="_blank" rel="noopener noreferrer">clearinxg.baselinux.net</a></li>
      <li><a href="https://hansobe.baselinux.net" target="_blank" rel="noopener noreferrer">hansobe.baselinux.net</a></li>
      <li><a href="https://jambali.baselinux.net" target="_blank" rel="noopener noreferrer">jambali.baselinux.net</a></li>
      <li><a href="https://kantabolt.baselinux.net" target="_blank" rel="noopener noreferrer">kantabolt.baselinux.net</a></li>
      <li><a href="https://nirbytesprobolt.chickenkiller.com" target="_blank" rel="noopener noreferrer">nirbytesprobolt.chickenkiller.com</a></li>
      <li><a href="https://boletrp.chickenkiller.com" target="_blank" rel="noopener noreferrer">boletrp.chickenkiller.com</a></li>
      <li><a href="https://clarendi.chickenkiller.com" target="_blank" rel="noopener noreferrer">clarendi.chickenkiller.com</a></li>
      <li><a href="https://diksedi.chickenkiller.com" target="_blank" rel="noopener noreferrer">diksedi.chickenkiller.com</a></li>
      <li><a href="https://jankdi.chickenkiller.com" target="_blank" rel="noopener noreferrer">jankdi.chickenkiller.com</a></li>
      <li><a href="http://ffehzuwacg.3cm.us/" target="_blank" rel="noopener noreferrer">ffehzuwacg.3cm.us</a></li>
      <li><a href="http://redswhyqsl.cartes.cl/" target="_blank" rel="noopener noreferrer">redswhyqsl.cartes.cl</a></li>
      <li><a href="http://hvtcgxbxel.moot.es/" target="_blank" rel="noopener noreferrer">hvtcgxbxel.moot.es</a></li>
      <li><a href="https://boltnirbytes.baselinux.net" target="_blank" rel="noopener noreferrer">boltnirbytes.baselinux.net</a></li>
      <li><a href="https://boltvixero.baselinux.net" target="_blank" rel="noopener noreferrer">boltvixero.baselinux.net</a></li>
      <li><a href="https://nirbytesboltx.baselinux.net" target="_blank" rel="noopener noreferrer">nirbytesboltx.baselinux.net</a></li>
      <li><a href="https://rumpka.baselinux.net" target="_blank" rel="noopener noreferrer">rumpka.baselinux.net</a></li>
      <li><a href="https://straline.baselinux.net" target="_blank" rel="noopener noreferrer">straline.baselinux.net</a></li>
      <li><a href="https://proxybynirb.jundy.org" target="_blank" rel="noopener noreferrer">proxybynirb.jundy.org</a></li>
      <li><a href="https://ntrakd.jundy.org" target="_blank" rel="noopener noreferrer">ntrakd.jundy.org</a></li>
      <li><a href="https://salmonxei.jundy.org" target="_blank" rel="noopener noreferrer">salmonxei.jundy.org</a></li>
      <li><a href="https://saugatranamgr.jundy.org" target="_blank" rel="noopener noreferrer">saugatranamgr.jundy.org</a></li>
    </ul>

    <!-- Rammerhead Proxies -->
    <h3>Rammerhead Proxy Links</h3>
    <ul class="link-list">
      <li><a href="https://iam.steveward.ws/" target="_blank" rel="noopener noreferrer">iam.steveward.ws</a></li>
      <li><a href="https://proxyslash.rocks" target="_blank" rel="noopener noreferrer">proxyslash.rocks</a></li>
      <li><a href="https://proxy.space" target="_blank" rel="noopener noreferrer">proxy.space</a></li>
      <li><a href="https://proxy.bscschool.net" target="_blank" rel="noopener noreferrer">proxy.bscschool.net</a></li>
      <li><a href="https://bam.svelte.school" target="_blank" rel="noopener noreferrer">bam.svelte.school</a></li>
      <li><a href="https://rammerhead.site" target="_blank" rel="noopener noreferrer">rammerhead.site</a></li>
      <li><a href="https://proxy.rammerhead.site" target="_blank" rel="noopener noreferrer">proxy.rammerhead.site</a></li>
      <li><a href="https://proxy-rhammerhead.com" target="_blank" rel="noopener noreferrer">proxy-rhammerhead.com</a></li>
    </ul>
  </section>

  <!-- Games Tab -->
  <section id="games" class="tab" role="tabpanel" tabindex="0" aria-label="Games Tab">
    <h2>Games</h2>
    <ul class="link-list">
      <li><a href="https://examplegame1.com" target="_blank" rel="noopener noreferrer">Example Game 1</a></li>
      <li><a href="https://examplegame2.com" target="_blank" rel="noopener noreferrer">Example Game 2</a></li>
      <li><a href="https://examplegame3.com" target="_blank" rel="noopener noreferrer">Example Game 3</a></li>
      <!-- Add more games as needed -->
    </ul>
  </section>

  <!-- Entertainment Tab -->
  <section id="entertainment" class="tab" role="tabpanel" tabindex="0" aria-label="Entertainment Tab">
    <h2>Entertainment</h2>
    <ul class="link-list">
      <li><a href="https://exampleentertainment1.com" target="_blank" rel="noopener noreferrer">Entertainment Site 1</a></li>
      <li><a href="https://exampleentertainment2.com" target="_blank" rel="noopener noreferrer">Entertainment Site 2</a></li>
      <li><a href="https://exampleentertainment3.com" target="_blank" rel="noopener noreferrer">Entertainment Site 3</a></li>
    </ul>
  </section>

  <!-- Unblocked Games Tab -->
  <section id="unblocked" class="tab" role="tabpanel" tabindex="0" aria-label="Unblocked Games Tab">
    <h2>Unblocked Games</h2>
    <ul class="link-list">
      <li><a href="https://unblockedgame1.com" target="_blank" rel="noopener noreferrer">Unblocked Game 1</a></li>
      <li><a href="https://unblockedgame2.com" target="_blank" rel="noopener noreferrer">Unblocked Game 2</a></li>
      <li><a href="https://unblockedgame3.com" target="_blank" rel="noopener noreferrer">Unblocked Game 3</a></li>
    </ul>
  </section>

  <!-- Support Tab -->
  <section id="support" class="tab" role="tabpanel" tabindex="0" aria-label="Support Tab">
    <h2>Support</h2>
    <form id="contact-form" action="https://formspree.io/f/xnnzldvp" method="POST" target="_blank" novalidate>
      <label for="name">Name <span aria-hidden="true" style="color:#f00">*</span></label><br />
      <input type="text" id="name" name="name" placeholder="Your name" required style="width:100%; max-width:400px; padding:8px; margin-bottom:10px;" />
      
      <label for="email">Email <span aria-hidden="true" style="color:#f00">*</span></label><br />
      <input type="email" id="email" name="email" placeholder="your.email@example.com" required style="width:100%; max-width:400px; padding:8px; margin-bottom:10px;" />
      
      <label for="message">Message <span aria-hidden="true" style="color:#f00">*</span></label><br />
      <textarea id="message" name="message" rows="5" placeholder="Write your message here..." required style="width:100%; max-width:400px; padding:8px; margin-bottom:10px;"></textarea>
      
      <button type="submit" style="background:var(--color-primary); color:#001a2e; border:none; padding:12px 28px; font-weight:bold; border-radius:8px; cursor:pointer; box-shadow: 0 0 10px var(--color-primary-light);">Send</button>
    </form>
    <p style="margin-top:15px; font-size:0.9rem; color:var(--color-primary-light);">We will respond as soon as possible. Thank you!</p>
  </section>

  <!-- Settings Tab -->
  <section id="settings" class="tab" role="tabpanel" tabindex="0" aria-label="Settings Tab">
    <h2>Settings</h2>

    <label for="panic-key">Panic Hotkey (Press to instantly open URL):</label>
    <input type="text" id="panic-key" placeholder="Press a key here to set hotkey" readonly aria-describedby="panic-info" />
    <label for="panic-url" style="margin-top:6px;">Panic URL:</label>
    <input type="url" id="panic-url" placeholder="https://example.com" />

    <button id="clear-panic" style="background:#ff4444; color:#fff; margin-top:8px;">Clear Panic Key</button>

    <p id="panic-info">Press the input box above and then press your desired hotkey.</p>

    <hr style="margin: 25px 0; border-color: var(--color-primary-light);" />

    <label for="mode-toggle">Color Mode:</label>
    <select id="mode-toggle" aria-label="Choose light or dark mode">
      <option value="dark">Dark Mode</option>
      <option value="light">Light Mode</option>
    </select>

    <label for="theme-select" style="margin-top:15px;">Theme Color:</label>
    <select id="theme-select" aria-label="Choose theme color">
      <option value="blue">Blue</option>
      <option value="red">Red</option>
      <option value="green">Green</option>
      <option value="purple">Purple</option>
      <option value="orange">Orange</option>
    </select>
  </section>
</main>

<script>
  // Password protection
  const passwordScreen = document.getElementById('password-screen');
  const passwordInput = document.getElementById('password-input');
  const passwordSubmit = document.getElementById('password-submit');
  const passwordError = document.getElementById('password-error');
  const correctPassword = 'shadow';

  function hidePasswordScreen() {
    passwordScreen.style.display = 'none';
    // Show weather/time bar after entering
    document.getElementById('weather-time-bar').style.display = 'flex';
  }

  passwordSubmit.addEventListener('click', () => {
    if(passwordInput.value === correctPassword) {
      hidePasswordScreen();
    } else {
      passwordError.textContent = 'Incorrect password. Try again.';
      passwordInput.value = '';
      passwordInput.focus();
    }
  });

  passwordInput.addEventListener('keydown', e => {
    if(e.key === 'Enter') {
      passwordSubmit.click();
    }
  });

  // Tabs functionality
  const tabs = document.querySelectorAll('nav button.tablink');
  const tabSections = document.querySelectorAll('main section.tab');

  function switchTab(newTab) {
    tabs.forEach(tab => {
      const isTarget = tab.dataset.tab === newTab;
      tab.classList.toggle('active', isTarget);
      tab.setAttribute('aria-selected', isTarget ? 'true' : 'false');
      tab.tabIndex = isTarget ? 0 : -1;
    });
    tabSections.forEach(section => {
      section.classList.toggle('active', section.id === newTab);
    });
  }

  tabs.forEach(tab => {
    tab.addEventListener('click', () => switchTab(tab.dataset.tab));
    tab.addEventListener('keydown', e => {
      if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
        const currentIndex = Array.from(tabs).indexOf(document.activeElement);
        let newIndex;
        if (e.key === 'ArrowRight') {
          newIndex = (currentIndex + 1) % tabs.length;
        } else {
          newIndex = (currentIndex - 1 + tabs.length) % tabs.length;
        }
        tabs[newIndex].focus();
      }
    });
  });

  // Changelog & Credits close buttons
  document.querySelectorAll('#changelog button.close, #credits button.close').forEach(btn => {
    btn.addEventListener('click', e => {
      e.target.parentElement.style.display = 'none';
    });
  });

  // Weather & local time bar
  const weatherTimeBar = document.getElementById('weather-time-bar');
  async function updateWeatherTime() {
    try {
      // Get geolocation
      if (!navigator.geolocation) {
        weatherTimeBar.textContent = 'Geolocation not supported.';
        return;
      }
      navigator.geolocation.getCurrentPosition(async position => {
        const lat = position.coords.latitude;
        const lon = position.coords.longitude;

        // Get weather from OpenWeatherMap (you need to insert your API key here)
        const apiKey = ''; // Insert your OpenWeatherMap API key here
        if(!apiKey) {
          weatherTimeBar.textContent = 'Please insert your OpenWeatherMap API key in the code.';
          return;
        }

        const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`);
        const data = await response.json();

        const temp = data.main.temp.toFixed(1);
        const conditions = data.weather[0].description;
        const city = data.name;

        // Get local time
        const now = new Date();
        const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

        weatherTimeBar.textContent = `Local Time: ${timeString} | Weather in ${city}: ${temp}°C, ${conditions}`;
      }, error => {
        weatherTimeBar.textContent = 'Unable to get location.';
      });
    } catch (error) {
      weatherTimeBar.textContent = 'Error fetching weather/time.';
    }
  }
  updateWeatherTime();
  setInterval(updateWeatherTime, 60000);

  // Settings - Panic Key
  const panicKeyInput = document.getElementById('panic-key');
  const panicUrlInput = document.getElementById('panic-url');
  const clearPanicBtn = document.getElementById('clear-panic');

  // Load saved panic key/url from localStorage
  function loadPanicSettings() {
    const savedKey = localStorage.getItem('panicKey');
    const savedUrl = localStorage.getItem('panicUrl');
    if(savedKey) panicKeyInput.value = savedKey.toUpperCase();
    if(savedUrl) panicUrlInput.value = savedUrl;
  }
  loadPanicSettings();

  // When user focuses on panic key input, listen for next key press
  panicKeyInput.addEventListener('focus', () => {
    panicKeyInput.value = '';
    const onKeyDown = e => {
      e.preventDefault();
      // Only accept single character or function keys (simplify)
      let key = e.key.toUpperCase();
      if(key === 'ESCAPE' || key === 'SHIFT' || key === 'CONTROL' || key === 'ALT' || key === 'TAB') {
        // Ignore modifier keys only
        return;
      }
      panicKeyInput.value = key;
      localStorage.setItem('panicKey', key);
      panicKeyInput.blur();
      document.removeEventListener('keydown', onKeyDown);
    };
    document.addEventListener('keydown', onKeyDown);
  });

  panicUrlInput.addEventListener('change', () => {
    localStorage.setItem('panicUrl', panicUrlInput.value);
  });

  clearPanicBtn.addEventListener('click', () => {
    panicKeyInput.value = '';
    panicUrlInput.value = '';
    localStorage.removeItem('panicKey');
    localStorage.removeItem('panicUrl');
  });

  // Listen globally for panic key press
  document.addEventListener('keydown', e => {
    const savedKey = localStorage.getItem('panicKey');
    const savedUrl = localStorage.getItem('panicUrl');
    if(savedKey && savedUrl) {
      if(e.key.toUpperCase() === savedKey) {
        // Redirect immediately to panic URL
        window.location.href = savedUrl;
      }
    }
  });

  // Settings - Dark/Light Mode and Theme Color

  const modeSelect = document.getElementById('mode-toggle');
  const themeSelect = document.getElementById('theme-select');

  // Theme colors definitions
  const themeColors = {
    blue: '#00aaff',
    red: '#ff4444',
    green: '#44bb44',
    purple: '#8855cc',
    orange: '#ff8800'
  };

  function applyTheme(colorName) {
    const color = themeColors[colorName] || themeColors.blue;
    document.documentElement.style.setProperty('--color-primary', color);
    // lighten version
    const lighten = lightenColor(color, 30);
    document.documentElement.style.setProperty('--color-primary-light', lighten);
    document.documentElement.style.setProperty('--color-link', color);
    document.documentElement.style.setProperty('--color-link-hover', lighten);
  }

  // Lighten color helper
  function lightenColor(color, percent) {
    // Assumes hex color like #RRGGBB
    let num = parseInt(color.slice(1), 16),
        r = (num >> 16) + percent,
        g = ((num >> 8) & 0x00FF) + percent,
        b = (num & 0x0000FF) + percent;

    r = (r > 255) ? 255 : r;
    g = (g > 255) ? 255 : g;
    b = (b > 255) ? 255 : b;

    return `rgb(${r},${g},${b})`;
  }

  // Load saved mode and theme
  function loadSettings() {
    const savedMode = localStorage.getItem('colorMode');
    const savedTheme = localStorage.getItem('themeColor');

    if(savedMode) {
      document.body.classList.remove('light', 'dark');
      document.body.classList.add(savedMode);
      modeSelect.value = savedMode;
    } else {
      // default dark
      document.body.classList.add('dark');
      modeSelect.value = 'dark';
    }

    if(savedTheme && themeColors[savedTheme]) {
      applyTheme(savedTheme);
      themeSelect.value = savedTheme;
    } else {
      applyTheme('blue');
      themeSelect.value = 'blue';
    }
  }

  modeSelect.addEventListener('change', () => {
    const mode = modeSelect.value;
    document.body.classList.remove('light', 'dark');
    document.body.classList.add(mode);
    localStorage.setItem('colorMode', mode);
  });

  themeSelect.addEventListener('change', () => {
    const theme = themeSelect.value;
    applyTheme(theme);
    localStorage.setItem('themeColor', theme);
  });

  loadSettings();

</script>

</body>
</html>
